# <center> Проект: Модель прогнозирования стоимости жилья для агентства недвижимости </center>

# Содержание проекта:

## 1. Исследование структуры данных
### 1.1. Чтение данных с помощью библиотеки Pandas.
[Скачать датасет можно здесь](https://drive.google.com/file/d/11-ZNNIdcQ7TbT8Y0nsQ3Q0eiYQP__NIW/view)
### 1.2. Ознакомление с признаками и их структурой.
### 1.3. Анализ информации о числе непустых значений в столбцах и их типах в таблице.
### 1.4. Анализ информации о числе непустых значений.
### 1.5. Изучение основной статистической информации о столбцах.

## 2. Преобразование данных
### 2.1. Преобразование признака 'Статус продажи'.
#### Обработка признака, выделение 6 наиболее значимых, удаление информации об аренде объектов.

### 2.2. Преобразование признака 'Наличие бассейна'.
#### Объединение двух признаков, определение объектов с собственным бассейном.

### 2.3. Преобразование признака 'Тип объекта'.
#### Обработка признака, выделение 7 наиболее значимых, удаление информации об объектах, продажа которых невозможна (apartment), и объектов с типом "земля".

### 2.4. Преобразование признака 'Адрес'.
#### Использован внешний ресурс с данными о о населении городов США свыше 100тыс. жителей: [википедии](https://ru.wikipedia.org/wiki/%D0%A1%D0%BF%D0%B8%D1%81%D0%BE%D0%BA_%D0%B3%D0%BE%D1%80%D0%BE%D0%B4%D0%BE%D0%B2_%D0%A1%D0%A8%D0%90_%D1%81_%D0%BD%D0%B0%D1%81%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D0%B5%D0%BC_%D0%B1%D0%BE%D0%BB%D0%B5%D0%B5_100_%D1%82%D1%8B%D1%81%D1%8F%D1%87_%D0%B6%D0%B8%D1%82%D0%B5%D0%BB%D0%B5%D0%B9). В результате создан новый признак "Населений", адрес преобразован в признак "тип улицы".

### 2.5. Преобразование признаков 'Количество ванных комнат'.
#### Обработка признака, выделение 6 наиболее значимых.

### 2.6. Преобразование признака 'Сведения об объекте'.
#### Выделены и обработаны 6 новых признаков: Год постройки, Год реконструкции, Отопление, Система охладжения, Парковка, Стоимость лота и Цена за квадратный фут.

### 2.7. Преобразование признака 'Сведения об школах'.
#### Выделены и обработаны 4 новых признаков: Количество школ, Средний рейтинг школ, Среднее расстояние до школ, Покрытие потребностей в уровнях обучения (использованы внешние данные об [уровнях образования в США](https://www.unipage.net/ru/schools_usa)).

### 2.8. Преобразование признака 'Наличие камина'.
#### Признак проанализирован, определено наличие и количество каминов в объекте недвижимости.

### 2.9. Преобразование признаков 'Количество спален'.
#### Обработка признака, выделение 8 наиболее значимых.

### 2.10. Преобразование признаков 'Количество этажей'.
#### Обработка признака, выделение 11 наиболее значимых.

## 3. Исследование выбросов в данных

### Проведен анализ выбросов в признаках :
* площадь объекта;
* цена за квадратный фут;
* стоимость объекта.

## 4. Очистка данных

### 4.1. Удалены выбросы по методике трёх сигм.

### 4.2. Удалены дубликаты из данных.

## 5. Проведено тетрирование различных моделей машинного обучения.,
### Построены модели при:
* наивная модель среднего;
* линейная регрессия;
* случайный лес с различными параметрами, в том числе с расчетом наилучших параметров с помощью интрумента optuna;
* модуль градиентного бустинга с различными параметрами, в том числе с расчетом наилучших параметров с помощью интрумента optuna;
* Модель CatBoostRegressor.
### Исследованы результаты предсказаний с учетом:
* базовых параметров;
* логарифмирования целового признака;
* нормализации признаков;
* совокупности примениемых методов.
### Определена оптимальная модель на основе метрик $R^2$, $MAE$, $MAPE$.

### Итоговая модель сохранена в формате .pickle файла.

## Использованные инструменты и библиотеки
* catboost (1.2)
* category-encoders (2.6.1)
* matplotlib (3.6.2)
* numpy (1.23.4)
* optuna (3.2.0)
* pandas (1.5.1)
* plotly (5.11.0)
* seaborn (0.12.1)
* squarify (0.4.3)
* scikit-learn (1.2.2)
* xgboost (1.7.6)



